<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>Login</title>
</head>
<body>
    <div id="container"></div>
    <script src="../js/react.development.js"></script>
    <script src="../js/react-dom.development.js"></script>
    <script src="../js/babel.min.js"></script>
    <script src="../js/sha256.js"></script>
    <script type="text/babel">
        //登录组件
        class Login extends React.Component{
            //登录的回调
            handleLogin = ()=>{
                var username = document.getElementById("username").value
                var password = document.getElementById("password").value
                password = sha256_digest(password)
                console.log(username,password);
                //向后端发送登录请求
                // var xhr = new XMLHttpRequest();
                // xhr.open("get","https://example.com/register?"+"username="+username+"&password="+password,true)
                // xhr.send("");
                // xhr.onreadystatechange = function(){
                //     console.log("1");
                //     if(xhr.readyState===4 && xhr.status===200){
                //         var date = xhr.responseText;
                //         console.log(xhr.responseText)
                //     }
                // }
                // console.log(xhr.responseText)
            }
            render(){
                return(
                    <div className="login">
                        <h1>登录</h1>
                        <input type="text" id="username"/>
                        <br/>
                        <input type="text" id="password"/>
                        <br/>
                        <button id="loginBtn" onClick={this.handleLogin}>登录</button>
                        <button id="logonNow" onClick={this.props.updateLogonNow}>注册</button>
                    </div>
                )
            }
        }
        //注册组件
        class Logon extends React.Component{
            //注册的回调
            handleLogon = ()=>{
                var username = document.getElementById("username").value
                var password = document.getElementById("password").value
                password = sha256_digest(password)
                console.log(username,password);
                //向后端发送注册请求
                // var xhr = new XMLHttpRequest();
                // xhr.open("get","https://example.com/register?"+"username="+username+"&password="+password,true)
                // xhr.send("");
                // xhr.onreadystatechange = function(){
                //     console.log("1");
                //     if(xhr.readyState===4 && xhr.status===200){
                //         var date = xhr.responseText;
                //         console.log(xhr.responseText)
                //     }
                // }
                // console.log(xhr.responseText)
            }
            render(){
                return(
                    <div className="logon">
                        <h1>注册</h1>
                        <input type="text" id="username"/>
                        <br/>
                        <input type="text" id="password"/>
                        <br/>
                        <button id="logonBtn" onClick={this.handleLogon}>注册</button>
                        <button id="logonBacktologin" onClick={this.props.updateLogonNow}>返回</button>
                    </div>
                )
            }
        }
        //app组件
        class App extends React.Component{
            //初始化状态
            state = {logonNow:false}
            //更新状态
            updateLogonNow = ()=>{
                //获取原状态
                const logonNow = this.state.logonNow
                //修改状态
                this.setState({logonNow:!logonNow})
            }
            //单一页面切换登录、注册
            render(){
                //获取logonNow
                const {logonNow} = this.state
                if (this.state.logonNow){
                    return(
                        <div>
                            <Logon updateLogonNow={this.updateLogonNow}/>
                        </div>
                    )
                }else{
                    return(
                        <div>
                            <Login updateLogonNow={this.updateLogonNow}/>
                        </div> 
                    )
                }
            }
        }
        //渲染组件到页面
        ReactDOM.render(<App/>, document.getElementById("container"))
    </script>
</body>
</html>